# Добавление администратора кластера 1C в файл *.lst

Программа ищет запущенные службы 1С по маске:

```cmd
    sc query
```
#### 

Далее с помощью regexp-a

```
if ru:
    pattern = "Имя_службы: (1C:.+)"
else:
    pattern = "SERVICE_NAME: (1C:.+)"
```

ищет все что может содержать "1С: ..."
и контрольно ищет необходимую службу следующим:

```
    if ru:
        pattern = 'Имя_двоичного_файла.+ -regport ([\d]+).+-port ([\d]+) .+-d "(.+)"'
    else:
        pattern = 'BINARY_PATH_NAME.+ -regport ([\d]+).+-port ([\d]+) .+-d "(.+)"'
```

## Алгоритм:

1. Определяет файл настроек кластера, если найдено больше одной запущенной предложит выбрать необходимую
2. Запрашивает имя добавляемого пользователя
3. Парсит файл настроек и вставляет в позицию пользователей нового
4. Предлагает перезапустить службу для применения новых настроек кластера

###### P.S. программа должна быть запущена от имени администратора
